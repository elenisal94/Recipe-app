<% layout ('layouts/boilerplate') %>
    <div id="cluster-map" class="mb-3"></div>
    <div class="mt-2 mb-3">
    <h1>All Recipes</h1>
    </div>
    <% for (let recipe of recipes){%>
        <div class="card mb-3">
            <div class="row">
                <div class="col-md-4 index-card-column">
                    <% if(recipe.images.length) {%>
                    <img class="index-img" alt="" src="<%=recipe.images[0].url%>">
                    <% }else{ %>
                    <img crossorigin="anonymous" class="index-img" alt="" src="https://res.cloudinary.com/dr35pjw8f/image/upload/v1709747988/ElenisRecipeParadise/chad-montano-gf9777gaYjs-unsplash_hx0wpc.jpg"
                    <% } %>
                </div>
                <div class="col-md-8">
                    <div class="card-body">
                        <h5 class="card-title">
                            <%= recipe.title %>
                        </h5>
                        <p class="card-text">
                            <%=recipe.description %>
                        </p>
                        <p class="card-text"><small class="text-muted">
                                <%= recipe.countryFullname %>
                            </small></p>
                        <a class="btn btn-primary" href="/recipes/<%=recipe._id%>">View <%=recipe.title%></a>
                    </div>
                </div>
            </div>

        </div>
        <% }%>
            <script>
                const mapToken = '<%-process.env.MAPBOX_TOKEN%>';
                const recipes = {features: <%- JSON.stringify(recipes) %>}
            </script>
            <script src="/javascripts/clusterMap.js"></script>